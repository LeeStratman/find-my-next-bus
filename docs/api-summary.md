## BusTime v3 Endpoint Cheat Sheet

| Endpoint              | What it does                                                                                                                                   | Key inputs                                                                           | Notable fields                                                                                                                                                                              |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `gettime`             | Returns BusTime’s current server time. Use as a heartbeat or to align clocks.                                                                  | `key`, optional `unixTime=true`.                                                     | `tm` string (`YYYYMMDD HH:MM:SS`) or Unix ms when `unixTime=true`.                                                                                                                          |
| `getvehicles`         | Live vehicle locators. Each record shows where a bus is, its block/trip, speed, delay flag, and passenger load.                                | Either `vid` (comma list) **or** `rt`. Optional `tmres`, `rtpidatafeed`.             | `lat`/`lon`, `rt`, `des`, `tmstmp`, `dly`, `psgld`.                                                                                                                                         |
| `getroutes`           | Inventory of every route in the system. Great for dropdowns or color coding.                                                                   | Optional `rtpidatafeed`.                                                             | `rt` (ID), `rtnm`, `rtclr` (hex), `rtdd` (display ID).                                                                                                                                      |
| `getdirections`       | Lists the direction IDs that a route supports (`INBOUND`, `EAST`, etc.).                                                                       | `rt` plus optional `rtpidatafeed`.                                                   | `id` (machine value) + `name` (localized string).                                                                                                                                           |
| `getstops`            | Either: (a) stop list for a route+direction or (b) individual stops (up to 10 IDs). Useful for drawing ordered stop pickers.                   | `rt`+`dir` **or** `stpid` list. Optional `rtpidatafeed`.                             | Each stop includes `stpid`, `stpnm`, coordinates, optional `gtfsseq` (the GTFS stop sequence—use it to keep stops in trip order), `dtradd`/`dtrrem` detour references, optional `ada` flag. |
| `getpatterns`         | Returns the polylines (stops + waypoints) that define a route’s patterns, including detour info.                                               | `rt` or up to 10 `pid` values, optional `rtpidatafeed`.                              | `ptr` objects contain ordered `pt` entries with `typ` (`S` stop / `W` waypoint), `pdist` (feet along pattern), and optional `dtrid`/`dtrpt` overlays for detours.                           |
| `getpredictions`      | Arrival/departure predictions for up to 10 stops or 10 vehicles. Includes countdown, cancellation flags, and passenger load.                   | `stpid` list **or** `vid` list. Optional `tmres`, `top`, `unixTime`, `rtpidatafeed`. | `prdctdn` (minutes), `prdtm`, `typ` (`A`/`D`), `dly` boolean, `dyn` (disruption action), `psgld`, `flagstop`.                                                                               |
| `getservicebulletins` | Service alerts at system, feed, route, direction, or stop granularity. Surfaces detours, relocations, etc.                                     | `rt` (optionally `rtdir`/`stpid`) **or** `stpid` list. Optional `rtpidatafeed`.      | Each `sb` includes `sbj`, `dtl`, `prty`, plus `srvc` entries indicating affected routes/directions/stops.                                                                                   |
| `getlocalelist`       | Lists supported locales and (optionally) their names in a target language.                                                                     | Optional `locale` or `inLocaleLanguage=true`.                                        | `localestring`, `displayname`.                                                                                                                                                              |
| `getrtpidatafeeds`    | Shows all data feeds configured (e.g., multiple agencies), whether they’re enabled/visible, and their source (`NEXTBUS`, `Bus Tracker`, etc.). | none beyond `key`.                                                                   | `name`, `source`, `enabled`, `visible`.                                                                                                                                                     |
| `getdetours`          | High-level detour feed: lists ID, description, affected routes/directions, start/end.                                                          | Optional `rt`, `rtdir`, `rtpidatafeed`.                                              | `dtr` with `id`, `desc`, `rtdirs`, `startdt`, `enddt`.                                                                                                                                      |
| `getenhanceddetours`  | Heavyweight detour feed for GTFS-RT: includes replacement patterns, trips, stop inserts/removals, etc.                                         | Optional `rtpidatafeed`.                                                             | Each `dtr` includes `ptrs` (encoded polylines), `repstops`, trip IDs, delays, etc.                                                                                                          |
| `getagencies`         | Lists every agency loaded from GTFS and their short/long names.                                                                                | none beyond `key`.                                                                   | `agencyid`, `shortname`, `longname`.                                                                                                                                                        |

### Common Parameters You’ll Reuse

- `key`: Your API key (required on every call).
- `format`: Set to `json` if you don’t want the XML default.
- `rtpidatafeed`: Required whenever the system has multiple feeds; otherwise optional.
- Routing parameters: `rt` (route ID), `dir` (direction ID returned by `getdirections`), `stpid` (stop ID), `vid` (vehicle ID).
- Paging/limits: `top` on `getpredictions`, `pid` list on `getpatterns`, etc.

### Why `gtfsseq` Matters

`gtfsseq` mirrors the GTFS stop sequence within a trip. Sorting stops by `gtfsseq` keeps them in the exact order that buses serve them, which is ideal for route-direction pickers or when showing “upstream/downstream” relationships. If BusTime omits `gtfsseq`, fall back to name/ID ordering.

Everything above is derived from `API.md`; let me know if you need a deeper dive into any response schema.

## Copy/Paste Parameter Reference

| Endpoint              | Required params                                               | Optional params                                                      | Notes / sample                                            |
| --------------------- | ------------------------------------------------------------- | -------------------------------------------------------------------- | --------------------------------------------------------- |
| `gettime`             | `key`                                                         | `unixTime` (`true/false`), `format`, `locale`                        | `gettime?key=YOUR_KEY&unixTime=true&format=json`          |
| `getvehicles`         | `key` **plus** either `vid` (comma list) or `rt` (comma list) | `tmres` (`m`/`s`), `rtpidatafeed`, `locale`, `format`                | `getvehicles?key=YOUR_KEY&rt=2,4&tmres=s`                 |
| `getroutes`           | `key`                                                         | `rtpidatafeed`, `locale`, `format`                                   | `getroutes?key=YOUR_KEY&format=json`                      |
| `getdirections`       | `key`, `rt`                                                   | `rtpidatafeed`, `locale`, `format`                                   | `getdirections?key=YOUR_KEY&rt=2&rtpidatafeed=bustime`    |
| `getstops`            | Either (`key`,`rt`,`dir`) **or** (`key`,`stpid` list)         | `rtpidatafeed`, up to 10 `stpid`, `locale`, `format`                 | `getstops?key=YOUR_KEY&rt=2&dir=West Bound`               |
| `getpatterns`         | `key` and either `rt` or `pid` list (≤10)                     | `rtpidatafeed`, `locale`, `format`                                   | `getpatterns?key=YOUR_KEY&rt=2`                           |
| `getpredictions`      | `key` plus either `stpid` list (≤10) or `vid` list (≤10)      | `rt`, `top`, `tmres`, `unixTime`, `rtpidatafeed`, `locale`, `format` | `getpredictions?key=YOUR_KEY&stpid=123,456&top=3&tmres=s` |
| `getservicebulletins` | `key` plus (`rt` or `stpid`)                                  | `rtdir`, `rtpidatafeed`, `locale`, `format`                          | `getservicebulletins?key=YOUR_KEY&rt=2&rtdir=East`        |
| `getlocalelist`       | `key`                                                         | `locale`, `inLocaleLanguage`, `format`                               | `getlocalelist?key=YOUR_KEY&inLocaleLanguage=true`        |
| `getrtpidatafeeds`    | `key`                                                         | `format`                                                             | `getrtpidatafeeds?key=YOUR_KEY`                           |
| `getdetours`          | `key`                                                         | `rt`, `rtdir`, `rtpidatafeed`, `format`                              | `getdetours?key=YOUR_KEY&rt=12`                           |
| `getenhanceddetours`  | `key`                                                         | `rtpidatafeed`, `format`                                             | `getenhanceddetours?key=YOUR_KEY`                         |
| `getagencies`         | `key`                                                         | `format`                                                             | `getagencies?key=YOUR_KEY`                                |

> All sample queries assume JSON by default; add `&format=json` if your deployment doesn’t default to JSON.
